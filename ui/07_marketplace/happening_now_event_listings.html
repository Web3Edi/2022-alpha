<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>Web 3 Edi - Happening Now Event Listings</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="../00_service_assets/main/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../00_service_assets/main/vendors/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../00_service_assets/main/vendors/images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/core.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/style.css">
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>

	
	<!-- Web 3 -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>


	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script>
</head>
<body>
	<div class="pre-loader">
		<div class="pre-loader-box">
			<div class="loader-logo"><img src="../00_service_assets/main/images/deskapp-logo.svg" alt="Web 3 Edi"></div>
			<div class='loader-progress' id="progress_div">
				<div class='bar' id='bar1'></div>
			</div>
			<div class='percent' id='percent1'>0%</div>
			<div class="loading-text">
				Loading...
			</div>
		</div>
	</div>

	<!-- NEW HEADER -->
	<div class="header">
		<div class="header-left">
			<div class="menu-icon dw dw-menu"></div>
			<div class="search-toggle-icon dw dw-search2" data-toggle="header_search"></div>
			<div class="header-search">
				<form>
					<div class="form-group mb-0">
						<i class="dw dw-search2 search-icon"></i>
						<input type="text" class="form-control search-input" placeholder="Search Here">
						<div class="dropdown">
							<a class="dropdown-toggle no-arrow" href="#" role="button" data-toggle="dropdown">
								<i class="ion-arrow-down-c"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-right">
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">From</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">To</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">Subject</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="text-right">
									<button class="btn btn-primary">Search</button>
								</div>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="header-right">
		
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" >
						<span id="show_wallet" class="user-name"></span>
						<span id="connect_web_3" class="user-name">Connect Web 3</span>
						<span class="user-icon">
							<img src="../00_service_assets/main/images/android-icon-192x192.png" alt="">
						</span>
						
					</a>
					
				</div>
			</div>
		</div>
	</div>
	<!-- END NEW HEADER -->
	<div class="left-side-bar">
		<div class="brand-logo">
			<a href="../01_campus/index.html">
				<img src="../00_service_assets/main/images/deskapp-logo.svg" alt="" class="dark-logo">
				<img src="../00_service_assets/main/images/deskapp-logo-white.svg" alt="" class="light-logo">
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
		<div class="menu-block customscroll">
			<div class="sidebar-menu">				
				<ul id="accordion-menu">
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-house-1"></span><span class="mtext">Campus</span>
						</a>
						<ul class="submenu">
							<li><a href="../01_campus/index.html">To Campus</a></li>
							<li><a href="../14_minting/index.html">Minting</a></li>
							<li><a href="../08_courtyard/index.html">Courtyard</a></li>
							<li><a href="../11_gallery/index.html">Galleries</a></li>
							<li><a href="../07_marketplace/course_directory.html">Course Directory</a></li>
							<li><a href="../09_community/index.html">Communities</a></li>
							
						</ul>
					</li>
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-money"></span><span class="mtext">Market Place</span>
						</a>
						<ul class="submenu">
							<li><a href="../07_marketplace/index.html">Market Place</a></li>
							<li><a href="../07_marketplace/course_directory.html">Courses</a></li>
							<li><a href="../07_marketplace/schools_offers.html">Schools</a></li>							
							<li><a href="../07_marketplace/happening_now_event_listings.html">Happening Now Events</a></li>							
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="mobile-menu-overlay"></div>

	<div class="main-container">
		<div class="pd-ltr-20 height-100-p xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-12 col-sm-12">
							<div class="title">
								<h4>Happening Now Event Listings</h4>
							</div>
						</div>
					</div>
				</div>
				<div class="blog-wrap">
					<div class="container pd-0">
						<div class="row">
							<div class="col-md-8 col-sm-12">
								<div class="blog-list">
									<ul id="listings_display">
						
									</ul>
								</div>
								<div class="blog-pagination">
									<div class="btn-toolbar justify-content-center mb-15">
										<div class="btn-group">											
											<a href="#" class="btn btn-outline-primary prev"><i class="fa fa-angle-double-left"></i></a>
											<span class="btn btn-primary current">1</span>
											<a href="#" class="btn btn-outline-primary">2</a>
											<a href="#" class="btn btn-outline-primary">3</a>											
											<a href="#" class="btn btn-outline-primary">4</a>
											<a href="#" class="btn btn-outline-primary">5</a>
											<a href="#" class="btn btn-outline-primary next"><i class="fa fa-angle-double-right"></i></a>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4 col-sm-12">
								<div class="card-box mb-30">
									<h5 class="pd-20 h5 mb-0">Categories</h5>
									<div class="list-group" id="category_listing_display">
									
									</div>
								</div>
								
						
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="footer-wrap pd-20 mb-20 card-box">
				&copy; Web 3 Edi 2022
			</div>
		</div>
	</div>
	<!-- js -->
	<script src="../00_service_assets/main/scripts/core.js"></script>
	<script src="../00_service_assets/main/scripts/script.min.js"></script>
	<script src="../00_service_assets/main/scripts/process.js"></script>
	<script src="../00_service_assets/main/scripts/layout-settings.js"></script>

	<!-- Web 3 ABI-->
	<script src="../00_service_assets/abi/open_register/i_open_register_abi.js"></script>       

	<!-- Web 3 Edi -->
	<script src="../00_service_assets/main/js/web_3_edi.js"></script>
	<script src="../00_service_assets/test/js/test_events.js"></script>

	<script> 	
			/*
				<li>
				<div class="row no-gutters">
					<div class="col-lg-4 col-md-12 col-sm-12">
						<div class="blog-img">
							<img src="vendors/images/img2.jpg" alt="" class="bg_img">
						</div>
					</div>
					<div class="col-lg-8 col-md-12 col-sm-12">
						<div class="blog-caption">
							<h4><a href="#">Lorem ipsum dolor sit amet, consectetur adipisicing elit</a></h4>
							<div class="blog-by">
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo</p>
								<div class="pt-10">
									<a href="#" class="btn btn-outline-primary">Read More</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</li>
		*/

		const listingsDisplay = ge("listings_display");
		const categoryDisplay = ge("category_listing_display");

		var categories = new Map();

		async function configurePageContracts(){ 

		}

		async function loadPageData() { 
			buildListings(); 
			buildCategories();

		}

		function buildListings() { 

			for( var x = 0; x < happeningNowEventListings.length; x++){
				var listing = happeningNowEventListings[x];
				buildListing(listing);
			}


		}
		
		function buildCategories () { 
			console.log(categories);
			var keys = categories.keys(); 
			console.log(keys);
			console.log(keys.length);
			for(const key of keys) {
				
				console.log(key);
				var categoryCount = categories.get(key);
				addCategory(key, categoryCount);
			}
		}

		function addCategory(category, categoryCount) {
			/*
			<a href="#" class="list-group-item d-flex align-items-center justify-content-between">HTML <span class="badge badge-primary badge-pill">7</span></a>
			*/
			var a = ce("a");
			a.setAttribute("href",getCategorySearchLink(category));
			a.setAttribute("class", "list-group-item d-flex align-items-center justify-content-between");
			a.append(text(category));			

			var span = ce("span");
			span.setAttribute("class", "badge badge-primary badge-pill");
			span.append(text(categoryCount));
			a.append(span);
			categoryDisplay.append(a);
			console.log(categoryDisplay);
			
		}

		function getCategorySearchLink(category) {
			return "../20_search/search?category="+category; 
		}

		function buildListing( listing) {
			
			
			if(!categories.has(listing.category) ) {
				categories.set(listing.category, 1);
			}
			else {
				var count = categories.get(listing.category);
				console.log(count);
				categories.set(listing.category, count++);
				console.log(count);

			}

			var li = ce("li");
			var row = ce("div");
			row.setAttribute("class", "row no-gutters");
			li.append(row);
			listingsDisplay.append(li);

			var imgCol = ce("div");			
			imgCol.setAttribute("class","col-lg-4 col-md-12 col-sm-12");
			row.append(imgCol);

			var imgDiv = ce("div");
			//imgDiv.setAttribute("class","blog-img");
			imgCol.append(imgDiv);

			var img = ce("img");
			img.setAttribute("src", listing.image);
			img.setAttribute("alt", listing.title);
			img.setAttribute("class", "bg_img");
			imgDiv.append(img);

			 var desc = ce("div");
			 desc.setAttribute("class", "col-lg-8 col-md-12 col-sm-12");
			 row.append(desc);

			 var caption = ce("div");
			 caption.setAttribute("class", "blog-caption");
			 desc.append(caption);

			 var h4 = ce("h4");
			 
			 var a = ce("a");
			 a.setAttribute("href", listing.link);
			 a.append(text(listing.title));
			h4.append(a);
			caption.append(h4);

			var b = ce("b");
			b.append(text("Event Date: " + listing.date));
			caption.append(b);
			
			var captionBody = ce("div");
			captionBody.setAttribute("class","blog-by");
			caption.append(captionBody);

			var p = ce("p");
			captionBody.append(p);
			p.append(text(listing.summary));

			var details = ce("div");
			details.setAttribute("class","pt-10");
			captionBody.append(details);

			var a1 = ce("a");
			a1.setAttribute("href", listing.link);
			a1.setAttribute("class","btn btn-outline-primary");
			a1.append(text("Join"));
			details.append(a1);
			details.append(text(" "));
			details.append(text(listing.price));
			details.append(text(" "));
			details.append(text(listing.currency));
			details.append(text(" Started @ " + listing.startTime));
			details.append(text(" Ends @ " + listing.endTime));

		}
			
		function ge(id) {
			return document.getElementById(id);
		}

		function text(txt) {
			return document.createTextNode(txt);
		}

		function ce(name) {
			return document.createElement(name);
		}

	</script> 
</body>
</html>