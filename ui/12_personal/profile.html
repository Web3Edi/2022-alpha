<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>Web 3 Edi - Your Public Profile</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="../00_service_assets/main//images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../00_service_assets/main//images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../00_service_assets/main//images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main//styles/core.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main//styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/other/plugins/cropperjs/dist/cropper.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/style.css">

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script>
	<!-- Web3 -->
	<script src="https://unpkg.com/ipfs-http-client-lite/dist/index.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>
	<div class="pre-loader">
		<div class="pre-loader-box">
			<div class="loader-logo"><img src="../00_service_assets/main/images/deskapp-logo.svg" alt=""></div>
			<div class='loader-progress' id="progress_div">
				<div class='bar' id='bar1'></div>
			</div>
			<div class='percent' id='percent1'>0%</div>
			<div class="loading-text">
				Loading...
			</div>
		</div>
	</div>

	<!-- NEW HEADER -->
	<div class="header">
		<div class="header-left">
			<div class="menu-icon dw dw-menu"></div>
			<div class="search-toggle-icon dw dw-search2" data-toggle="header_search"></div>
			<div class="header-search">
				<form>
					<div class="form-group mb-0">
						<i class="dw dw-search2 search-icon"></i>
						<input type="text" class="form-control search-input" placeholder="Search Here">
						<div class="dropdown">
							<a class="dropdown-toggle no-arrow" href="#" role="button" data-toggle="dropdown">
								<i class="ion-arrow-down-c"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-right">
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">From</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">To</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">Subject</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="text-right">
									<button class="btn btn-primary">Search</button>
								</div>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="header-right">
		
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" >
						<span id="show_wallet" class="user-name"></span>
						<span id="connect_web_3" class="user-name">Connect Web 3</span>
						<span class="user-icon">
							<img src="../00_service_assets/main/images/android-icon-192x192.png" alt="">
						</span>
						
					</a>
					
				</div>
			</div>
		</div>
	</div>
	<!-- END NEW HEADER -->



	<div class="left-side-bar">
		<div class="brand-logo">
			<a href="../01_campus/index.html">
				<img src="../00_service_assets/main/images/deskapp-logo.svg" alt="" class="dark-logo">
				<img src="../00_service_assets/main/images/deskapp-logo-white.svg" alt="" class="light-logo">
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
		<div class="menu-block customscroll">
			<div class="sidebar-menu">				
				<ul id="accordion-menu">
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-house-1"></span><span class="mtext">Campus</span>
						</a>
						<ul class="submenu">
							<li><a href="../01_campus/index.html">To Campus</a></li>
							<li><a href="../14_minting/index.html">Minting</a></li>
							<li><a href="../07_marketplace/index.html">Marketplace</a></li>
							<li><a href="../08_courtyard/index.html">Courtyard</a></li>
							<li><a href="../11_gallery/index.html">Galleries</a></li>
							<li><a href="../07_marketplace/course_directory.html">Course Directory</a></li>
							<li><a href="../09_community/index.html">Communities</a></li>
							
						</ul>
					</li>
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-user"></span><span class="mtext">Home</span>
						</a>
						<ul class="submenu">
							<li><a href="../12_personal/profile.html">Profile</a></li>
							<!-- <li><a href="../12_personal/locker.html">Locker</a></li>
							<li><a href="../12_personal/colleagues.html">Colleagues</a></li>
							<li><a href="../12_personal/preferences.html">Preferences</a></li> --> 
							
						</ul>
					</li>				
				</ul>
			</div>
		</div>
	</div>
	<div class="mobile-menu-overlay"></div>

	<div class="main-container">
		<div class="pd-ltr-20 xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-12 col-sm-12">
							<div class="title">
								<h4>Your Web 3 Edi Profile</h4>
							</div>

						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 mb-30">
						<div class="pd-20 card-box height-100-p">
				
							<div class="profile-info">
								<h5 class="text-center h5 mb-0"><span id="nickname_display_span"></span></h5>
								<span id="personal_description_display_span"></span>
								<span id="user_photo_display_span"></span>
							</div>
												
					
							<div class="profile-info">
								<h5 class="mb-20 h5 text-blue">Contact Information</h5>
								<ul>
									<li>
										<span id="user_nft_display_span"></span>
										<span id="web_3_edi_nft_title"></span>
									</li>
									<li>
										<span>Edi Address:</span>
										<span id="edi_address_span"></span>
									</li>
									<li>
										<span>Badges</span>
										<span id="school_badges_display_span"></span>
									</li>
								</ul>
							</div>
							<div class="profile-social">
								<h5 class="mb-20 h5 text-blue">Schools</h5>
								<ul class="clearfix" id="school_crest_display_span">
									<!--<li><a href="#" class="btn" data-bgcolor="#3b5998" data-color="#ffffff"><i class="fa fa-facebook"></i></a></li>-->

								</ul>
							</div>
							<div class="profile-social">
								<h5 class="mb-20 h5 text-blue">Communities</h5>
								<ul class="clearfix" id="communities_icons_display_span">
									<!--<li><a href="#" class="btn" data-bgcolor="#3b5998" data-color="#ffffff"><i class="fa fa-facebook"></i></a></li>-->

								</ul>
							</div>
							
						</div>
					</div>
					<div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 mb-30">
						<div class="card-box height-100-p overflow-hidden">
							<div class="profile-tab height-100-p">
								<div class="tab height-100-p">
									<ul class="nav nav-tabs customtab" role="tablist">
										<li class="nav-item">
											<a class="nav-link active" data-toggle="tab" href="#timeline" role="tab">Timeline</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" data-toggle="tab" href="#setting" role="tab">Settings</a>
										</li>
									</ul>
									<div class="tab-content">
										<!-- Timeline Tab start -->
										<div class="tab-pane fade show active" id="timeline" role="tabpanel">
											<div class="pd-20">
												<div class="profile-timeline" id="profile_timeline_display_div">
												
												</div>
											</div>
										</div>
										<!-- Timeline Tab End -->

										<!-- Setting Tab start -->
										<div class="tab-pane fade height-100-p" id="setting" role="tabpanel">
											<div class="profile-setting">
												<form>
													<ul class="profile-edit-list row">
														<li class="weight-500 col-md-6">
															<h4 class="text-blue h5 mb-20">Edit Your Personal Setting</h4>
															<div class="form-group">
																<label>Nickname</label>
																<input class="form-control form-control-lg" type="text" id="edi_nickname">
															</div>
															<div class="form-group">
																<label>Personal Description</label>
																<input class="form-control form-control-lg" type="text">
															</div>
															<div class="form-group mb-0">
																<input type="submit" class="btn btn-primary" value="Save & Update">
															</div>
														</li>
														<li class="weight-500 col-md-6">

														</li>
													</ul>
												</form>
											</div>
										</div>
										<!-- Setting Tab End -->
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="footer-wrap pd-20 mb-20 card-box">
				&copy; Web 3 Edi 2022
			</div>
		</div>
	</div>
	<!-- js -->
	<script src="../00_service_assets/main//scripts/core.js"></script>
	<script src="../00_service_assets/main//scripts/script.min.js"></script>
	<script src="../00_service_assets/main//scripts/process.js"></script>
	<script src="../00_service_assets/main//scripts/layout-settings.js"></script>
	<script src="../00_service_assets/other/plugins/cropperjs/dist/cropper.js"></script>
	<script>
		window.addEventListener('DOMContentLoaded', function () {
			var image = document.getElementById('image');
			var cropBoxData;
			var canvasData;
			var cropper;

			$('#modal').on('shown.bs.modal', function () {
				cropper = new Cropper(image, {
					autoCropArea: 0.5,
					dragMode: 'move',
					aspectRatio: 3 / 3,
					restore: false,
					guides: false,
					center: false,
					highlight: false,
					cropBoxMovable: false,
					cropBoxResizable: false,
					toggleDragModeOnDblclick: false,
					ready: function () {
						cropper.setCropBoxData(cropBoxData).setCanvasData(canvasData);
					}
				});
			}).on('hidden.bs.modal', function () {
				cropBoxData = cropper.getCropBoxData();
				canvasData = cropper.getCanvasData();
				cropper.destroy();
			});
		});
	</script>
	<!-- Web 3 ABI-->
	<script src="../00_service_assets/abi/open_register/i_open_register_abi.js"></script> 

	<!-- JS-->
	<script src="../00_service_assets/test/js/test_communities.js"></script>
	<script src="../00_service_assets/test/js/test_badges.js"></script>
	<script src="../00_service_assets/test/js/test_schools.js"></script>
	<script src="../00_service_assets/test/js/test_profile.js"></script>
	<!-- Web 3 Edi -->
	<script src="../00_service_assets/main/js/web_3_edi.js"></script>
	<script>

		const userPhotoDisplaySpan 				= ge("user_photo_display_span");
		const nicknameDisplaySpan 				= ge("nickname_display_span");
		const personalDescriptionDisplaySpan 	= ge("personal_description_display_span");
		const userNFTDisplaySpan				= ge("user_nft_display_span");
		const ediAddressSpan					= ge("edi_address_span");
		const schoolBadgesDisplaySpan			= ge("school_badges_display_span");
		const communitiesIconsDisplaySpan		= ge("communities_icons_display_span");
		const web3ediNFTTitle					= ge("web_3_edi_nft_title");
		const schoolsDisplaySpan			= ge("school_crest_display_span");
		const profileTimeLineDisplayDiv 	= ge("profile_timeline_display_div");

		const BADGE_HEIGHT = 30; 
		const BADGE_WIDTH = 30; 

		function configurePageContracts() { 

		}

		function loadPageData(){ 
			buildProfile(); 
		}

		function buildProfile() {

			ediAddressSpan.innerHTML = account; 
			nicknameDisplaySpan.innerHTML = profile.nickname; 
			personalDescriptionDisplaySpan.innerHTML = "<b>About Me:</b><br/>"+ profile.description; 
			buildProfileImage(); 
			buildBadges(); 
			buildSchools(); 
			buildCommunities(); 
			buildTimeLine(); 

		}

		function buildProfileImage()  { 
							/* <a href="modal" data-toggle="modal" data-target="#modal" class="edit-avatar"><i class="fa fa-pencil"></i></a>-->
								<!--<img src="../00_service_assets/main/images/photo1.jpg" alt="" class="avatar-photo">-->
								<!--
									<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered" role="document">
											<div class="modal-content">
												<div class="modal-body pd-5">
													<div class="img-container">
														<img id="image" src="vendors/images/photo2.jpg" alt="Picture">
													</div>
												</div>
												<div class="modal-footer">
													<input type="submit" value="Update" class="btn btn-primary">
													<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
												</div>
											</div>
										</div>
									</div>
								*/
			var img = ce("img");
			img.setAttribute("src", profile.image);	
			img.setAttribute("alt", profile.nickname);
			
			
			userPhotoDisplaySpan.append(img);

			var nft = ce("img");
			nft.setAttribute("src", profile.web3edinft);
			nft.setAttribute("alt", profile.web3edinft_title);
			nft.setAttribute("class","da-card-photo");
			nft.setAttribute("width",150);
			nft.setAttribute("height",150);
			userNFTDisplaySpan.setAttribute("align","center");
			userNFTDisplaySpan.append(nft);
			var b = ce("b");
			web3ediNFTTitle.append(b);

			b.append(text("Web 3 Edi NFT: "));
			web3ediNFTTitle.append(text(profile.web3edinft_title));
			
		}

		 const rowLength = 5; 
		function buildBadges() {
			
			var table 	= ce("table");
			var row 	= table.insertRow();  
			var badges 	= profile.badges; 
			console.log(badges);

			for(var x = 0; x < badges.length; x++) {
				var cell = row.insertCell(); 
				var badge = badges[x];
				var img = ce("img");
				img.setAttribute("src", badge);
				img.setAttribute("height", BADGE_HEIGHT);
				img.setAttribute("width", BADGE_WIDTH);
				cell.append(img);
			}
			schoolBadgesDisplaySpan.innerHTML = ""; 
			schoolBadgesDisplaySpan.append(table);
		}


		function buildCommunities() { 
			var table = ce("table");
			table.setAttribute("padding","5px");
			var row  = table.insertRow(); 
			var communities = profile.communities; 
			for(var x = 0; x < communities.length; x++) {
				var community = communities[x];
				var cell = row.insertCell();
				
				var img = ce("img");
				img.setAttribute("src", community.image);
				img.setAttribute("alt", community.title);
				img.setAttribute("height", BADGE_HEIGHT+30);
				img.setAttribute("width", BADGE_WIDTH +30);
				cell.append(img);
				var filler = row.insertCell();
				filler.append(text (" "));
			}
			communitiesIconsDisplaySpan.append(table);
		}


		function buildSchools() {
			/*
			
			
			*/

			var table = ce("table");
			table.setAttribute("padding","5px");
			var row  = table.insertRow(); 
			var schools = profile.schools; 
			for(var x = 0; x < schools.length; x++) {
				var school = schools[x];
				var cell = row.insertCell();
				
				var img = ce("img");
				img.setAttribute("src", school.crest);
				img.setAttribute("alt", school.name);
				img.setAttribute("height", BADGE_HEIGHT+30);
				img.setAttribute("width", BADGE_WIDTH +30);
				cell.append(img);
				var filler = row.insertCell();
				filler.append(text (" "));
			}
			schoolsDisplaySpan.append(table);
		}

		function buildTimeLine() {
			/*
				<div class="timeline-month">
														<h5>August, 2022</h5>
													</div>
													<div class="profile-timeline-list">
														<ul>
															<li>
																<div class="date">12 Aug</div>
																<div class="task-name"><i class="ion-trophy"></i>Python Certificate Awarded</div>
																<p>School: ML Python</p>
	
															</li>
															<li>
																<div class="date">14 Aug</div>
																<div class="task-name"><i class="ion-flame"></i>Honours Badge Awarded</div>
																<p>School: W 3 NFT</p>
	
															</li>
														</ul>
													</div>
			
			*/
		    var timeLineMonth = ce("div");
			timeLineMonth.setAttribute("class", "timeline-month");
			profileTimeLineDisplayDiv.append(timeLineMonth);
			var h5 = ce("h5");
			timeLineMonth.append(h5);
			h5.append(text("Awards"));

			var profileTimeList = ce("div");
			timeLineMonth.append(profileTimeList);

			var ul = ce("ul");
			profileTimeList.append(ul);
			buildProfileEvents(ul, profile.events);
		}

		function buildProfileEvents(ul, profileEvents) {
			for(var x = 0; x < profileEvents.length; x++) {
				var profileEvent = profileEvents[x];
				var li = ce("li");
				var date = ce("div");
				date.setAttribute("class", "date");
				date.append(text(getTime(profileEvent.date)));
				li.append(date);
				ul.append(li);

				var award = ce("div");
				award.setAttribute("class", "task-name");
				li.append(award);
				var i = ce("i");
				i.setAttribute("class", "ion-trophy");
				award.append(i);
				award.append(profileEvent.award);
				var p = ce("p");
				var b = ce("b");
				p.append(b);
				b.append(text("School:"));
				p.append(text(profileEvent.school));
				li.append(p);
			}
		}

		function clearFields() { 
            for(var x = 0; x < components.length; x++) {
                var component = components[x];
                component.innerHTML = ""; 
            }
        }
        function strfy(value) {
            return JSON.stringify(value);
        }
        function getTime(numeric) {
            var d = new Date(numeric*1000);
            return formatDate(d);
        }
        function formatDate(date) {
            return date.toLocaleString('en-UK', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', hour12: false, minute: '2-digit', second: '2-digit' })
        }
        function ge(id) {
            return document.getElementById(id);
        }

        function text(txt) {
            return document.createTextNode(txt);
        }

        function ce(name) {
            return document.createElement(name);
        }
	</script>
</body>
</html>