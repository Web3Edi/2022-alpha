<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>Web 3 Edi - Educator Workroom</title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="../00_service_assets/main/images/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../00_service_assets/main/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../00_service_assets/main/images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/core.css">
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/icon-font.min.css">	
	<link rel="stylesheet" type="text/css" href="../00_service_assets/main/styles/style.css">

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script>
	<!-- Web3 -->
	<script src="https://unpkg.com/ipfs-http-client-lite/dist/index.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>
	<div class="pre-loader">
		<div class="pre-loader-box">
			<div class="loader-logo"><img src="../00_service_assets/main/images/deskapp-logo.svg" alt=""></div>
			<div class='loader-progress' id="progress_div">
				<div class='bar' id='bar1'></div>
			</div>
			<div class='percent' id='percent1'>0%</div>
			<div class="loading-text">
				Loading...
			</div>
		</div>
	</div>
	
	<!-- NEW HEADER -->
	<div class="header">
		<div class="header-left">
			<div class="menu-icon dw dw-menu"></div>
			<div class="search-toggle-icon dw dw-search2" data-toggle="header_search"></div>
			<div class="header-search">
				<form>
					<div class="form-group mb-0">
						<i class="dw dw-search2 search-icon"></i>
						<input type="text" class="form-control search-input" placeholder="Search Here">
						<div class="dropdown">
							<a class="dropdown-toggle no-arrow" href="#" role="button" data-toggle="dropdown">
								<i class="ion-arrow-down-c"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-right">
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">From</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">To</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="form-group row">
									<label class="col-sm-12 col-md-2 col-form-label">Subject</label>
									<div class="col-sm-12 col-md-10">
										<input class="form-control form-control-sm form-control-line" type="text">
									</div>
								</div>
								<div class="text-right">
									<button class="btn btn-primary">Search</button>
								</div>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="header-right">
		
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" >
						<span id="show_wallet" class="user-name"></span>
						<span id="connect_web_3" class="user-name">Connect Web 3</span>
						<span class="user-icon">
							<img src="../00_service_assets/main/images/android-icon-192x192.png" alt="">
						</span>
						
					</a>
					
				</div>
			</div>
		</div>
	</div>
	<!-- END NEW HEADER -->

	<div class="left-side-bar">
		<div class="brand-logo">
			<a href="../01_campus/index.html">
				<img src="../00_service_assets/main/images/deskapp-logo.svg" alt="" class="dark-logo">
				<img src="../00_service_assets/main/images/deskapp-logo-white.svg" alt="" class="light-logo">
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
		<div class="menu-block customscroll">
			<div class="sidebar-menu">				
				<ul id="accordion-menu">
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-house-1"></span><span class="mtext">Campus</span>
						</a>
						<ul class="submenu">
							<li><a href="../01_campus/index.html">To Campus</a></li>
							<li><a href="../14_minting/index.html">Minting</a></li>
							<li><a href="../07_marketplace/index.html">Marketplace</a></li>
							<li><a href="../08_courtyard/index.html">Courtyard</a></li>
							<li><a href="../11_gallery/index.html">Galleries</a></li>
							<li><a href="../07_marketplace/course_directory.html">Course Directory</a></li>
							<li><a href="../09_community/index.html">Communities</a></li>
							
						</ul>
					</li>
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-user"></span><span class="mtext">Home</span>
						</a>
						<ul class="submenu">
							<li><a href="../12_personal/profile.html">Profile</a></li>
							<!--<li><a href="../12_personal/locker.html">Locker</a></li>
							<li><a href="../12_personal/colleagues.html">Colleagues</a></li>
							<li><a href="../12_personal/preferences.html">Preferences</a></li>-->
							
						</ul>
					</li>
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-edit2"></span><span class="mtext">Workroom</span>
						</a>
						<ul class="submenu">
							<li><a href="index.html">Dashboard</a></li>
							<li><a href="live_studio.html">Live Studio</a></li>
						</ul>
					</li>
				<!--	<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-school"></span><span class="mtext">School</span>
						</a>
						<ul class="submenu">
							<li><a href="../17_school/school_manager.html">School Manager</a></li>
						</ul>
					</li> -->
				<!--	<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-book-1"></span><span class="mtext">Courses</span>
						</a>
						<ul class="submenu">		
							<li><a href="../15_course/index.html">Course Manager</a></li>
							<li><a href="../15_course/course_creator.html">Create Course</a></li>							
						</ul>
					</li> -->
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon dw dw-calendar-1"></span><span class="mtext">Events</span>
						</a>
						<ul class="submenu">
							<li><a href="../16_event/event_manager.html">Event Manager</a></li>
							<li><a href="../16_event/event_creator.html">Create Event</a></li>
						</ul>
					</li>

				</ul>
			</div>
		</div>
	</div>
	<div class="mobile-menu-overlay"></div>

	<div class="main-container">
		<div class="xs-pd-20-10 pd-ltr-20">

			<div class="title pb-20">
				<h2 class="h3 mb-0">Educator Overview</h2>
			</div>

			<div class="row pb-10">
				<div class="col-xl-3 col-lg-3 col-md-6 mb-20">
					<div class="card-box height-100-p widget-style3">
						<div class="d-flex flex-wrap">
							<div class="widget-data">
								<div class="weight-700 font-24 text-dark">75</div>
								<div class="font-14 text-secondary weight-500">New Students</div>
							</div>
							<div class="widget-icon">
								<div class="icon" data-color="#00eccf"><i class="icon-copy dw dw-user"></i></div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-3 col-md-6 mb-20">
					<div class="card-box height-100-p widget-style3">
						<div class="d-flex flex-wrap">
							<div class="widget-data">
								<div class="weight-700 font-24 text-dark">124,551</div>
								<div class="font-14 text-secondary weight-500">Students in Training</div>
							</div>
							<div class="widget-icon">
								<div class="icon" data-color="#ff5b5b"><span class="icon-copy ti-blackboard"></span></div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-3 col-md-6 mb-20">
					<div class="card-box height-100-p widget-style3">
						<div class="d-flex flex-wrap">
							<div class="widget-data">
								<div class="weight-700 font-24 text-dark">400+</div>
								<div class="font-14 text-secondary weight-500">Minted Courses</div>
							</div>
							<div class="widget-icon">
								<div class="icon"><i class="icon-copy fa fa-chain" aria-hidden="true"></i></div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-3 col-lg-3 col-md-6 mb-20">
					<div class="card-box height-100-p widget-style3">
						<div class="d-flex flex-wrap">
							<div class="widget-data">
								<div class="weight-700 font-24 text-dark">$50,000</div>
								<div class="font-14 text-secondary weight-500">Lifetime Earnings</div>
							</div>
							<div class="widget-icon">
								<div class="icon" data-color="#09cc06"><i class="icon-copy fa fa-money" aria-hidden="true"></i></div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="row">
	
							<div class="col-lg-4 col-md-6 col-sm-12 mb-30">
					<div class="card-box pd-30 pt-10 height-100-p">
						<h2 class="mb-30 h4">Best Selling Courses</h2>
						<div class="browser-visits">
							<ul>
								<li class="d-flex flex-wrap align-items-center">
									<div class="icon"><img src="../00_service_assets/main/images/apple-touch-icon.png" alt=""></div>
									<div class="browser-name">Learning Python</div>
									<div class="visit"><span class="badge badge-pill badge-primary">50%</span></div>
								</li>
								<li class="d-flex flex-wrap align-items-center">
									<div class="icon"><img src="../00_service_assets/main/images/apple-touch-icon.png" alt=""></div>
									<div class="browser-name">Building Blockchain with Python</div>
									<div class="visit"><span class="badge badge-pill badge-secondary">40%</span></div>
								</li>
								<li class="d-flex flex-wrap align-items-center">
									<div class="icon"><img src="../00_service_assets/main/images/apple-touch-icon.png" alt=""></div>
									<div class="browser-name">ML using Python</div>
									<div class="visit"><span class="badge badge-pill badge-success">40%</span></div>
								</li>
	
							</ul>
						</div>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 mb-20">
					<div class="card-box height-100-p pd-20 min-height-200px">
						<div class="d-flex justify-content-between pb-10">
							<div class="h5 mb-0">Tasks</div>
							
						</div>
						<div class="user-list">
							<p class="pb-20">Select a task to begin</p>
							<ul>
								<!-- <li class="d-flex align-items-center justify-content-between">
									<div class="name-avatar d-flex align-items-center pr-2">
										<div class="avatar mr-2 flex-shrink-0">
											<img src="../00_service_assets/main/images/apple-touch-icon.png" class="border-radius-100 box-shadow" width="50" height="50" alt=""> 
										</div>
										<div class="txt">											
											<div class="font-14 weight-600">Create a Course</div>											
										</div>
									</div>
									<div class="cta flex-shrink-0">
										<a href="../15_course/course_creator.html" class="btn btn-sm btn-outline-primary rounded" onclick="window.location.href='course_creator.html';">Create</a>
									</div>
								</li> -->
								<li class="d-flex align-items-center justify-content-between">
									<div class="name-avatar d-flex align-items-center pr-2">
										<div class="avatar mr-2 flex-shrink-0">
											<img src="../00_service_assets/main/images/apple-touch-icon.png" class="border-radius-100 box-shadow" width="50" height="50" alt=""> <!-- course logo -->
										</div>
										<div class="txt">											
											<div class="font-14 weight-600">Start a Live</div>											
										</div>
									</div>
									<div class="cta flex-shrink-0">
										<a href="live_studio.html" class="btn btn-sm btn-outline-primary">Start</a>
									</div>
								</li>
								<li class="d-flex align-items-center justify-content-between">
									<div class="name-avatar d-flex align-items-center pr-2">
										<div class="avatar mr-2 flex-shrink-0">
											<img src="../00_service_assets/main/images/apple-touch-icon.png" class="border-radius-100 box-shadow" width="50" height="50" alt=""> <!-- course logo -->
										</div>
										<div class="txt">											
											<div class="font-14 weight-600">Schedule Event</div>											
										</div>
									</div>
									<div class="cta flex-shrink-0">
										<a href="../16_event/event_creator.html" class="btn btn-sm btn-outline-primary">Schedule</a>
									</div>
								</li>
							<!-- <li class="d-flex align-items-center justify-content-between">
									<div class="name-avatar d-flex align-items-center pr-2">
										<div class="avatar mr-2 flex-shrink-0">
											<img src="../00_service_assets/main/images/apple-touch-icon.png" class="border-radius-100 box-shadow" width="50" height="50" alt="">
										</div>
										<div class="txt">											
											<div class="font-14 weight-600">Manage your School</div>											
										</div>
									</div>
									<div class="cta flex-shrink-0">
										<a href="../17_school/school_manager.html" class="btn btn-sm btn-outline-primary">Manage</a>
									</div>
								</li> -->
							</ul>
						</div>
					</div>
				</div>
				<div class="col-lg-4 col-md-6 col-sm-12 mb-30">
					<div class="card-box pd-30 pt-10 height-100-p">
						
							<h4 class="h4">Notifications</h4>
							<span id="upcoming_events"></span>	
						
					</div>
				</div>
			</div>

			<div class="footer-wrap pd-20 mb-20 card-box">
				&copy; Web 3 Edi 2022
			</div>
		</div>
	</div>
	<!-- js -->
	<script src="../00_service_assets/main/scripts/core.js"></script>
	<script src="../00_service_assets/main/scripts/script.min.js"></script>
	<script src="../00_service_assets/main/scripts/process.js"></script>
	<script src="../00_service_assets/main/scripts/layout-settings.js"></script>

	<!-- Web 3 ABI-->
	<script src="../00_service_assets/abi/open_register/i_open_register_abi.js"></script>  
	
	<script src="../00_service_assets/abi/event/i_event_abi.js"></script>              
    <script src="../00_service_assets/abi/event/i_event_manager_abi.js"></script>

    <!-- Web 3 Edi -->
    <script src="../00_service_assets/main/js/web_3_edi.js"></script>
	
	
	<script>
		const upcomingEventDisplay = ge("upcoming_events");
		var eventManagerContract;
		var eventManagerContractAddress; 

		function configurePageContracts() { 
			openRegistryContract.methods.getAddress("RESERVED_WEB_3_EDI_EVENT_MANAGER_CORE").call({ from: account })
			.then(function(response) {
				console.log(response);
				eventManagerContractAddress = response;
				eventManagerContract = getContract(iW3EEventManagerAbi, eventManagerContractAddress);
			})
			.catch(function(err) {
				console.log(err);
			});
		}

		function loadPageData() {
			buildUpcomingEvents();
		}

		function buildUpcomingEvents() {
			upcomingEventDisplay.innerHTML = "";
			eventManagerContract.methods.getEvents().call({from : account})
			.then(function(response){
				console.log(response);
				var uEvents = response; 
				for(var x = 0; x < uEvents.length; x++){
					var uEvent = uEvents[x];        
					buildUpcomingEvent( uEvent);    
				}
			})
			.catch(function(err){
				console.log(err);
			});
		}

		function bue(eventContract, eventContractAddress,  startTimeActual, endtimeActual) {
		/*	<div class="alert alert-success alert-dismissible fade show" role="alert">
								<strong>Holy guacamole!</strong> You should check in on some of those fields below.
								<button type="button" class="close" data-dismiss="alert" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div> */

			var holder = ce("div");
			holder.setAttribute("class", "alert alert-success alert-dismissible fade show"); 
			holder.setAttribute("role", "alert");
			
		

			var startTime = ce("span");
			var endTime = ce("span");

			var uedisplay = ce("div");
			uedisplay.setAttribute("style", "justify-content:center;")
			var small = ce("small");
			small.append(startTime);
			small.append(text(" - "));
			small.append(endTime);
			uedisplay.append(small);

			startTime.append(text(getTime(startTimeActual)));
			endTime.append(text(getTime(endtimeActual)));

			var title = ce("span");
			uedisplay.append(text(" > "));
			uedisplay.append(title);

			eventContract.methods.getTitle().call({from : account})
			.then(function(response){
				console.log(response);
				title.append(text(response));        
			})
			.catch(function(err){
				console.log(err);
			});        
			
			uedisplay.append(text(" > "));
			var a = ce("a");
			a.setAttribute("href", "../16_event/event_detail.html?address="+eventContractAddress);
			a.setAttribute("class", "btn btn-outline-light btn-sm");
			a.append(text("view"));

			uedisplay.append(a);
			holder.append(uedisplay);

			
			var button = ce("button");
			holder.append(button);
			button.setAttribute("type","button");
			button.setAttribute("class","close");
			button.setAttribute("data-dismiss","alert");
			button.setAttribute("aria-label", "Close");
			var span = ce("span");
			span.setAttribute("aria-hidden","true");
			span.append(text("X"));
			button.append(span);

			upcomingEventDisplay.append(holder);
		}


		function buildUpcomingEvent(upcomingEvent){
			
			var eventContract = getContract(iW3EEventAbi, upcomingEvent);

			var startTimeActual; 
			var endTimeActual; 

			eventContract.methods.getFeatureUINT("START_TIME_KEY").call({from : account})
			.then(function(response){
				console.log(response);
				startTimeActual = response; 
				eventContract.methods.getFeatureUINT("END_TIME_KEY").call({from : account})
				.then(function(response){
					console.log(response);
					endTimeActual = response; 
					var rightNow = Date.now();
					if(!(startTimeActual*1000 < rightNow && endTimeActual < rightNow)){
						bue( eventContract, upcomingEvent, startTimeActual, endTimeActual);
					}
				})
				.catch(function(err){
					console.log(err);
				});

			})
			.catch(function(err){
				console.log(err);
			});
		}

		function getTime(numeric) {
            var d = new Date(numeric*1000);
            return formatDate(d);
        }
        function formatDate(date) {
            return date.toLocaleString('en-UK', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', hour12: false, minute: '2-digit', second: '2-digit' })
        }
        function ge(id) {
            return document.getElementById(id);
        }

        function text(txt) {
            return document.createTextNode(txt);
        }

        function ce(name) {
            return document.createElement(name);
        }
	</script>
</body>
</html>